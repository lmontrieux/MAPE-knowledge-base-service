{
    "$schema": "http://json-schema.org/schema/#",

    "definitions": {

        "id-pair": {
            "type": "object",
            "properties": {
                "UserId": { "type": "string" },
                "GroupName": { "type": "string" },
                "GroupId": { "type": "string" },
            }
        },

        "ip-range": {
            "CidrIp": { "type": "string" }
        },

        "prefix-list-id": {
            "PrefixListId": { "type": "string" }
        },

        "rule": {
            "type": "object",
            "properties": {
                "IpProtocol": { "type": "string" },
                "FromPort": { "type": "integer" },
                "ToPort": { "type": "integer" },
                "UserIdGroupPairs": {
                    "type": "array",
                    "items": { "$ref": "#/definitions/id-pair" }
                },
                "IpRanges": {
                    "type": "array",
                    "items": { "$ref": "#/definitions/ip-range" }
                },
                "PrefixListIds": {
                    "type": "array",
                    "items": { "$ref": "#/definitions/prefix-list-id" }
                }
            }
        },

        "tag": {
            "type": "object",
            "properties": {
                "Key": { "type": "string" },
                "Value": { "type": "string" }
            }
        }
    },

    "type": "object",
    "properties": {
        "SecurityGroups": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "OwnerId": { "type": "string" },
                    "GroupName": { "type": "string" },
                    "GroupId": { "type": "string" },
                    "Description": { "type": "string" },
                    "IpPermissions": {
                        "type": "array",
                        "items": { "$ref": "#/definitions/rule" }
                    },
                    "IpPermissionsEgress": {
                        "type": "array",
                        "items": { "$ref": "#/definitions/rule" }
                    },
                    "VpcId": { "type": "string"},
                    "Tags": {
                        "type": "array",
                        "items": { "$ref": "#/definitions/tag"}
                    }
                }
            }
        }
    }
}
